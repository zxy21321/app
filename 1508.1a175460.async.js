"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[1508],{95990:function(e,r,n){n.d(r,{A:function(){return i}});var r=n(97857),t=n.n(r),a=(n(67294),n(85893));function i(e){return(0,a.jsx)("svg",t()(t()({xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",viewBox:"0 0 24 24"},e),{},{children:(0,a.jsx)("path",{fill:"currentColor",d:"M6.4 19L5 17.6l5.6-5.6L5 6.4L6.4 5l5.6 5.6L17.6 5L19 6.4L13.4 12l5.6 5.6l-1.4 1.4l-5.6-5.6z"})}))}},51508:function(e,r,n){n.d(r,{Z:function(){return a}});var r=n(19632),b=n.n(r),r=n(15009),k=n.n(r),r=n(99289),y=n.n(r),j=n(95990),A=n(92633),N=n(15704),C=n(78234),L=n(67294),E=n(67421),P=n(55678);function T(){return t.apply(this,arguments)}function t(){return(t=y()(k()().mark(function e(o){var s,u,r=arguments;return k()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return s=1<r.length&&void 0!==r[1]?r[1]:1024,u=2<r.length&&void 0!==r[2]?r[2]:.7,e.abrupt("return",new Promise(function(a,e){var i=new Image;i.src=URL.createObjectURL(o),i.onload=function(){var e=document.createElement("canvas"),r=e.getContext("2d"),n=i.width,t=i.height;s<n&&(t=Math.round(t*=s/n),n=s),e.width=n,e.height=t,r.drawImage(i,0,0,n,t),e.toBlob(function(e){e=new File([e],o.name,{type:o.type});a(e)},o.type,u)},i.onerror=e}));case 3:case"end":return e.stop()}},e)}))).apply(this,arguments)}var z=n(85893),a=function(e){function u(e){return/image\/\w*/.test(e.type)}var r=e.isMultiple,t=void 0!==r&&r,c=e.onChange,r=e.children,n=e.preview,a=e.currentUrls,i=e.minHeight,i=void 0===i?140:i,o=e.onlyHeight,o=void 0===o?140:o,s=e.isPreview,s=void 0===s||s,l=e.uploadApiUrl,p=void 0===l?A.Z.UPLOAD_URL:l,l=e.requestData,f=void 0===l?{}:l,l=e.isCompressed,d=void 0===l||l,l=e.fileType,h=void 0===l?"image":l,m=(0,E.$G)().t,v=(0,L.useRef)(null),x=function(){var r=y()(k()().mark(function e(r){var n,t,a,i,o,s;return k()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!r){e.next=40;break}if("image"!==h){e.next=4;break}if(u(r)){e.next=4;break}return e.abrupt("return",P.Am.error(m("请选择一个有效的图片文件!")));case 4:if("video"!==h){e.next=7;break}if(/^video\//.test(r.type)){e.next=7;break}return e.abrupt("return",P.Am.error(m("请选择一个有效的视频文件!")));case 7:if(e.prev=7,n=new FormData,409600<(t=r).size&&d&&"image"===h)return console.log("大于400kb,执行压缩图片"),e.next=15,T(r);e.next=16;break;case 15:t=e.sent;case 16:return n.append("file",t),null!=(o=Object.keys(f))&&o.forEach(function(e){n.append(e,f[e])}),e.next=20,fetch(p,{method:"POST",body:n});case 20:if((a=e.sent).ok)return e.next=24,a.json();e.next=31;break;case 24:if(0!==(i=e.sent).code)return e.abrupt("return",P.Am.error(m("文件上传失败!")));e.next=27;break;case 27:o=i.data,null!=c&&c(o),e.next=35;break;case 31:return e.next=33,a.json();case 33:return s=e.sent,e.abrupt("return",P.Am.error(s));case 35:e.next=40;break;case 37:return e.prev=37,e.t0=e.catch(7),e.abrupt("return",P.Am.error(m("上传文件时发生错误!")));case 40:case"end":return e.stop()}},e,null,[[7,37]])}));return function(e){return r.apply(this,arguments)}}(),g=function(){var r=y()(k()().mark(function e(r){var n,t;return k()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,(n=Array.from(r).map(function(){var r=y()(k()().mark(function e(r){var n,t,a,i,o;return k()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("image"!==h){e.next=3;break}if(u(r)){e.next=3;break}throw new Error(m("请选择一个有效的图片文件!"));case 3:if("video"!==h){e.next=6;break}if(u(r)){e.next=6;break}throw new Error(m("请选择一个有效的视频文件!"));case 6:if(n=new FormData,409600<(t=r).size&&d&&"image"===h)return console.log("大于400kb,执行压缩图片"),e.next=13,T(r);e.next=14;break;case 13:t=e.sent;case 14:return n.append("file",t),null!=(o=Object.keys(f))&&o.forEach(function(e){n.append(e,f[e])}),e.next=18,fetch(p,{method:"POST",body:n});case 18:if((a=e.sent).ok)return e.next=22,a.json();e.next=28;break;case 22:if(0!==(i=e.sent).code)throw new Error(m("文件上传失败!"));e.next=25;break;case 25:return e.abrupt("return",i.data);case 28:return e.next=30,a.json();case 30:throw o=e.sent,new Error(o);case 32:case"end":return e.stop()}},e)}));return function(e){return r.apply(this,arguments)}}())).length)return e.next=5,Promise.all(n);e.next=7;break;case 5:t=e.sent,requestAnimationFrame(function(){null!=c&&c(function(e){return[].concat(b()(e),b()(t))})});case 7:e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),P.Am.error(e.t0.message||m("上传文件时发生错误!"));case 12:case"end":return e.stop()}},e,null,[[0,9]])}));return function(e){return r.apply(this,arguments)}}(),w=function(){var r=y()(k()().mark(function e(r){var n;return k()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("video"===h)return null!=c&&c(null==(n=r.target.files)?void 0:n[0]),e.abrupt("return");e.next=3;break;case 3:t?g(r.target.files):x(null==(n=r.target.files)?void 0:n[0]);case 4:case"end":return e.stop()}},e)}));return function(e){return r.apply(this,arguments)}}();return(0,C.Z)(function(){var e;return null!=(e=v.current)&&e.addEventListener("change",w),{unmount:function(){var e;null!=(e=v.current)&&e.removeEventListener("change",w)}}}),(0,z.jsxs)(z.Fragment,{children:[(0,z.jsxs)("div",{className:"w-full flex  justify-center relative",style:{minHeight:i},onClick:function(r){setTimeout(function(){var e;null!=(e=v.current)&&e.click(),r.stopPropagation()})},children:[(!a||0===(null==a?void 0:a.length)||!s)&&r,0<(null==a?void 0:a.length)&&s&&(0,z.jsxs)("div",{className:"relative w-full z-10",style:{minHeight:i},children:[!n&&t&&(0,z.jsx)("div",{className:"bg-backgroundAuxiliaryTextColor py-4 px-4",style:{minHeight:i},children:(0,z.jsx)("div",{className:"grid grid-cols-3 gap-[20px]",children:null==a?void 0:a.map(function(e,r){return(0,z.jsxs)("div",{className:"relative group/item w-full",children:[(0,z.jsx)(N.J,{classNames:{wrapper:"!max-w-[100%]"},className:"w-full h-[60px] rounded-md cursor-pointer object-cover",src:e}),(0,z.jsx)(j.A,{onClick:function(e){var n;e.stopPropagation(),n=r,t?null!=c&&c(function(e){return null==e?void 0:e.filter(function(e,r){return r!==n})}):null!=c&&c("")},width:"1.2em",height:"1.2em",className:"absolute z-50   cursor-pointer   items-center top-0 right-0  bg-backgroundAuxiliaryTextColor"})]},e+r)})})}),!n&&!t&&(0,z.jsx)("div",{className:"w-full",children:(0,z.jsx)("div",{className:"bg-backgroundAuxiliaryTextColor w-full ",style:{height:o},children:(0,z.jsxs)("div",{className:"relative w-full  pr-14   py-4 px-4",style:{height:o},children:[(0,z.jsx)(N.J,{classNames:{wrapper:"!max-w-[100%] !h-[100%]"},className:"w-full h-[100%] rounded-md cursor-pointer object-cover",src:a}),(0,z.jsx)(j.A,{onClick:function(e){e.stopPropagation(),null!=c&&c("")},width:"1.6em",height:"1.6em",className:"absolute z-50  cursor-pointer items-center top-1/2 -translate-y-1/2 right-2  bg-backgroundAuxiliaryTextColor"})]})})}),n]})]}),(0,z.jsx)("input",{ref:v,multiple:t,type:"file",className:"hidden",accept:"".concat(h,"/*")})]})}}}]);